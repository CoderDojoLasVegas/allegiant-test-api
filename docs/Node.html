<!DOCTYPE html>

<html>
<head>
  <title>Node.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>Node.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="allegiant-air-apis">Allegiant Air APIs</h2>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>These APIs provide the data necessary to complete your UX challenge.</p>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>The following operations are supported on this resource:</p>
<ul>
<li><code>GET</code></li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>The following resources are part of this group:</p>
<ul>
<li>/airlines</li>
<li>/airports</li>
<li>/allegiantRoutes</li>
<li>/scheduleFromDate</li>
<li>/scheduleToDate</li>
<li>/weather</li>
<li>/newsFromKeyword</li>
<li>/flickrFromKeyword</li>
<li>/flickrStaticImgUrl</li>
<li>/hotels</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>





<span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);

<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">var</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">"url"</span>);
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">var</span> querystring = <span class="hljs-built_in">require</span>(<span class="hljs-string">"querystring"</span>);
<span class="hljs-keyword">var</span> parseString = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xml2js'</span>).parseString;
<span class="hljs-keyword">var</span> options = {};
<span class="hljs-keyword">var</span> urlString = {};
<span class="hljs-keyword">var</span> postData = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="base-uri-">Base URI:</h2>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p><a href="http://localhost:8080">http://localhost:8080</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> app = express();
<span class="hljs-keyword">var</span> server = http.createServer(app).listen(<span class="hljs-number">8080</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2 id="airlines-api-airlines-">Airlines API: <code>/airlines</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>The Airlines API provides basic reference data about one or more airlines.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/airlines'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.flightstats.com"</span>,
        path:<span class="hljs-string">"/flex/airlines/rest/v1/json/active?appId=0980daa7&amp;appKey=7c87bd8cc1bd7d46d633f4d944cd7d8d"</span>,
        dataType:<span class="hljs-string">"json"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="airports-api-airports-">Airports API: <code>/airports</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>The Airports API provides basic reference data about one or more airports.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/airports'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.flightstats.com"</span>,
        path:<span class="hljs-string">"/flex/airports/rest/v1/json/countryCode/US?appId=0980daa7&amp;appKey=7c87bd8cc1bd7d46d633f4d944cd7d8d"</span>,
        dataType:<span class="hljs-string">"json"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2 id="allegiant-seasonal-flights-api-allegiantroutes-">Allegiant Seasonal Flights API: <code>/allegiantRoutes</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>The Allegiant Seasonal Flights API provides Allegiant route information. Origins and destinations are returned by the airport code.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/allegiantRoutes'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>

    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };



    fs.readFile(<span class="hljs-string">'./allegiant_flights.json'</span>, <span class="hljs-string">'utf8'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(err,data)</span> {</span>
        <span class="hljs-keyword">if</span> (err) { console.error(err); }

        <span class="hljs-keyword">var</span> store = data;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2 id="jsonp-support">JSONP support</h2>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Wraps json object in callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (urlString.queryparam.callback &amp;&amp; urlString.queryparam.callback != <span class="hljs-string">'?'</span>) {
            store = store.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"\\'"</span>);
            jsonp_store = urlString.queryparam.callback + <span class="hljs-string">"("</span> + store + <span class="hljs-string">");"</span>;
            store = jsonp_store;
        }

        res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>});
        res.write(store);
        res.end();
    });
});</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2 id="departing-flight-schedules-api-schedulefromdate-">Departing Flight Schedules API: <code>/scheduleFromDate</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>The Schedules API offers information on future scheduled flights, departing on the given date.</p>

            </div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>departureAirportCode</code>    The code of the departing airport.</li>
<li><code>arrivalAirportCode</code>    The code of the arrival airport.</li>
<li><code>year</code>                    Four-digit year of departure date.</li>
<li><code>month</code>                Month (1 to 12) of the departure date.</li>
<li><code>day</code>                    Day of month of the departure date.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/scheduleFromDate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    departureAirportCode = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.departureAirportCode);
    arrivalAirportCode = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.arrivalAirportCode);
    year = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.year);
    month = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.month);
    day = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.day);

    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.flightstats.com"</span>,
        path:<span class="hljs-string">"/flex/schedules/rest/v1/json/from/"</span>+departureAirportCode+<span class="hljs-string">"/to/"</span>+arrivalAirportCode+<span class="hljs-string">"/departing/"</span>+year+<span class="hljs-string">"/"</span>+month+<span class="hljs-string">"/"</span>+day+<span class="hljs-string">"?appId=0980daa7&amp;appKey=7c87bd8cc1bd7d46d633f4d944cd7d8d"</span>,
        dataType:<span class="hljs-string">"json"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2 id="arriving-flight-schedules-api-scheduletodate-">Arriving Flight Schedules API: <code>/scheduleToDate</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>The Schedules API offers information on future scheduled flights, arriving on the given date.</p>

            </div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>departureAirportCode</code>    The code of the departing airport.</li>
<li><code>arrivalAirportCode</code>    The code of the arrival airport.</li>
<li><code>year</code>                    Four-digit year of departure date.</li>
<li><code>month</code>                Month (1 to 12) of the departure date.</li>
<li><code>day</code>                    Day of month of the departure date.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/scheduleToDate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    departureAirportCode = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.departureAirportCode);
    arrivalAirportCode = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.arrivalAirportCode);
    year = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.year);
    month = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.month);
    day = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.day);

    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.flightstats.com"</span>,
        path:<span class="hljs-string">"/flex/schedules/rest/v1/json/from/"</span>+departureAirportCode+<span class="hljs-string">"/to/"</span>+arrivalAirportCode+<span class="hljs-string">"/arriving/"</span>+year+<span class="hljs-string">"/"</span>+month+<span class="hljs-string">"/"</span>+day+<span class="hljs-string">"?appId=0980daa7&amp;appKey=7c87bd8cc1bd7d46d633f4d944cd7d8d"</span>,
        dataType:<span class="hljs-string">"json"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <h2 id="weather-api-weather-">Weather API: <code>/weather</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>The Weather API returns weather information for the given airport.</p>

            </div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>airport</code>    The code of the airport.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/weather'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    airport = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.airport);

    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.flightstats.com"</span>,
        path:<span class="hljs-string">"/flex/weather/rest/v1/json/all/"</span>+airport+<span class="hljs-string">"?appId=0980daa7&amp;appKey=7c87bd8cc1bd7d46d633f4d944cd7d8d"</span>,
        dataType:<span class="hljs-string">"json"</span>,
        method:<span class="hljs-string">"GET"</span>,
        callback:urlString.queryparam
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <h2 id="news-api-newsfromkeyword-">News API: <code>/newsFromKeyword</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>The News API returns headlines pertaining to the given keyword.</p>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>p</code>    The keyword you want to search for.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/newsFromKeyword'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    p = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.p);

    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"news.search.yahoo.com"</span>,
        path:<span class="hljs-string">"/news/rss?p="</span>+p+<span class="hljs-string">"&amp;c=&amp;eo=UTF-8"</span>,
        dataType:<span class="hljs-string">"XML"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <h2 id="flickr-api-flickrfromkeyword-">Flickr API: <code>/flickrFromKeyword</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>The Flickr API returns images and relative information tagged with the given keyword.</p>

            </div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>tags</code>    The tag you want to search for.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/flickrFromKeyword'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
    tags = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.tags);

    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.flickr.com"</span>,
        path:<span class="hljs-string">"/services/feeds/photos_public.gne?tags="</span>+tags,
        dataType:<span class="hljs-string">"XML"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h2 id="flickr-static-image-api-flickrstaticimgurl-">Flickr Static Image API: <code>/flickrStaticImgUrl</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>The Flickr Static Image API removes the standard Flickr protection code and returns a URL of just the static image.</p>

            </div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>url</code>    The url of the image of which you are wanting the static version.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/flickrStaticImgUrl'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    flickrUrl = urlString.queryparam.url;
    <span class="hljs-keyword">var</span> photoID = flickrUrl.match(<span class="hljs-regexp">/\/photos\/(.*)/</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">1</span>];
    postData = querystring.stringify({<span class="hljs-string">'photo_id'</span>:photoID});

    <span class="hljs-keyword">var</span> flickrReq = http.request({
        host: <span class="hljs-string">'www.flickr.com'</span>,
        port: <span class="hljs-number">80</span>,
        path: <span class="hljs-string">'/services/rest/?method=flickr.photos.getInfo&amp;format=json&amp;api_key=a66ae3b787a9d02a3da0f2b63ac621be'</span>,
        method: <span class="hljs-string">'POST'</span>,
        headers: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded'</span>,
            <span class="hljs-string">'Content-Length'</span>: Buffer.byteLength(postData)
        }
    }, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> {</span>
        <span class="hljs-keyword">var</span> flickrStore = <span class="hljs-string">''</span>;

        response.setEncoding(<span class="hljs-string">'utf8'</span>);
        response.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(chunk)</span> {</span>
            flickrStore += chunk;
        });

        response.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
            flickrStore = flickrStore.replace(<span class="hljs-string">'jsonFlickrApi('</span>, <span class="hljs-string">''</span>);
            flickrStore = flickrStore.replace(<span class="hljs-regexp">/\)(?=[^.]*$)/</span>, <span class="hljs-string">''</span>);
            flickrStore = <span class="hljs-built_in">JSON</span>.parse(flickrStore);
            flickrStore = <span class="hljs-string">'http://farm'</span>+flickrStore.photo.farm+<span class="hljs-string">'.static.flickr.com/'</span>+flickrStore.photo.server+<span class="hljs-string">'/'</span>+photoID+<span class="hljs-string">'_'</span>+flickrStore.photo.secret+<span class="hljs-string">'.jpg'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <h2 id="jsonp-support">JSONP support</h2>

            </div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Wraps json object in callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (urlString.queryparam.callback &amp;&amp; urlString.queryparam.callback != <span class="hljs-string">'?'</span>) {
                jsonp_store = urlString.queryparam.callback + <span class="hljs-string">"('"</span> + flickrStore + <span class="hljs-string">"');"</span>;
                flickrStore = jsonp_store;
            }

            res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>});
            res.write(flickrStore);
            res.end();

        })
    });

    flickrReq.write(postData);
    flickrReq.end();

});</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <h2 id="hotel-api-hotels-">Hotel API: <code>/hotels</code></h2>

            </div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>The Hotel API returns a list of hotels and relative information based on a given location.</p>

            </div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>PARAMETERS</p>
<ul>
<li><code>city</code>                The city you wish to search for hotels in.</li>
<li><code>state</code>            The state (abbreviation: NV) you wish to search for hotels in.</li>
<li><code>arrivalMonth</code>        The month of the date when you would potentially check-in to the hotel.</li>
<li><code>arrivalDay</code>        The day of the date when you would potentially check-in to the hotel.</li>
<li><code>arrivalYear</code>        The year of the date when you would potentially check-in to the hotel.</li>
<li><code>departureMonth</code>    The month of the date when you would potentially check-out to the hotel.</li>
<li><code>departureDay</code>        The day of the date when you would potentially check-out to the hotel.</li>
<li><code>departureYear</code>    The year of the date when you would potentially check-out to the hotel.</li>
<li><code>numOfResults</code>        The number of results you want returned.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
app.get(<span class="hljs-string">'/hotels'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res, next)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
    city = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.city);
    state = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.state);
    arrivalMonth = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.arrivalMonth);
    arrivalDay = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.arrivalDay);
    arrivalYear = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.arrivalYear);
    departureMonth = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.departureMonth);
    departureDay = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.departureDay);
    departureYear = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.departureYear);
    numOfResults = <span class="hljs-built_in">encodeURIComponent</span>(urlString.queryparam.numOfResults);

    options = {
        <span class="hljs-comment">/*remove protocol from url*/</span>
        host:<span class="hljs-string">"api.eancdn.com"</span>,
        path:<span class="hljs-string">"/ean-services/rs/hotel/v3/list?cid=55505&amp;minorRev=99&amp;apiKey=emsqfvp7bxw2najqprquswcd&amp;locale=en_US&amp;currencyCode=USD&amp;xml=&lt;HotelListRequest&gt;%0A%20%20%20%20&lt;city&gt;"</span> + city + <span class="hljs-string">"&lt;%2Fcity&gt;%0A%20%20%20%20&lt;stateProvinceCode&gt;"</span> + state + <span class="hljs-string">"&lt;%2FstateProvinceCode&gt;%0A%20%20%20%20&lt;countryCode&gt;US&lt;%2FcountryCode&gt;%0A%20%20%20%20&lt;arrivalDate&gt;"</span> + arrivalMonth + <span class="hljs-string">"%2F"</span> + arrivalDay + <span class="hljs-string">"%2F"</span> + arrivalYear + <span class="hljs-string">"&lt;%2FarrivalDate&gt;%0A%20%20%20%20&lt;departureDate&gt;"</span> + departureMonth + <span class="hljs-string">"%2F"</span> + departureDay + <span class="hljs-string">"%2F"</span> + departureYear + <span class="hljs-string">"&lt;%2FdepartureDate&gt;%0A%20%20%20%20&lt;RoomGroup&gt;%0A%20%20%20%20%20%20%20%20&lt;Room&gt;%0A%20%20%20%20%20%20%20%20%20%20%20%20&lt;numberOfAdults&gt;2&lt;%2FnumberOfAdults&gt;%0A%20%20%20%20%20%20%20%20&lt;%2FRoom&gt;%0A%20%20%20%20&lt;%2FRoomGroup&gt;%0A%20%20%20%20&lt;numberOfResults&gt;"</span> + numOfResults + <span class="hljs-string">"&lt;%2FnumberOfResults&gt;%0A&lt;%2FHotelListRequest&gt;"</span>,
        dataType:<span class="hljs-string">"XML"</span>,
        method:<span class="hljs-string">"GET"</span>
    };

    next();
});



app.use(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res)</span> {</span>
    res.header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);

    <span class="hljs-keyword">var</span> urlString = {
        pathname: req.path,
        queryparam: req.query
    };

    <span class="hljs-keyword">var</span> store = <span class="hljs-string">" "</span>;

    http.request(options, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> {</span>
        response.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(chunk)</span> {</span>
            store += chunk;
        });
        response.on(<span class="hljs-string">'error'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> {</span>
            console.log(e);
        });

        response.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
            <span class="hljs-keyword">if</span> (options.dataType==<span class="hljs-string">"XML"</span>) {
                parseString(store, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(err, result)</span> {</span>
                    <span class="hljs-keyword">if</span> (err) { console.error(err); }
                    <span class="hljs-keyword">if</span> (result!=<span class="hljs-literal">undefined</span>) {
                        store = <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> ? <span class="hljs-built_in">JSON</span>.stringify(result) : result;
                    }
                });
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <h2 id="jsonp-support">JSONP support</h2>

            </div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Wraps json object in callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (urlString.queryparam.callback &amp;&amp; urlString.queryparam.callback != <span class="hljs-string">'?'</span>) {
                jsonp_store = urlString.queryparam.callback + <span class="hljs-string">"("</span> + store + <span class="hljs-string">");"</span>;
                store = jsonp_store;
            }

            res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>});
            res.write(store);
            res.end();
        });


    }).end();
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
